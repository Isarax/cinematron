!function(e){e.ajaxPrefilter(function(e){return e.iframe?"iframe":void 0}),e.ajaxTransport("iframe",function(t){function n(){e(l).each(function(){this.remove()}),e(c).each(function(){this.disabled=!1}),i.attr("action",o||"").attr("target",a||"").attr("enctype",s||""),r.attr("src","javascript:false;").remove()}var i=null,r=null,o=null,a=null,s=null,l=[],c=[],u=e(t.files).filter(":file:enabled");return t.dataTypes.shift(),u.length?(u.each(function(){null!==i&&this.form!==i&&jQuery.error("All file fields must belong to the same form"),i=this.form}),i=e(i),o=i.attr("action"),a=i.attr("target"),s=i.attr("enctype"),i.find(":input:not(:submit)").each(function(){!this.disabled&&("file"!=this.type||u.index(this)<0)&&(this.disabled=!0,c.push(this))}),"string"==typeof t.data&&t.data.length>0&&jQuery.error("data must not be serialized"),e.each(t.data||{},function(t,n){e.isPlainObject(n)&&(t=n.name,n=n.value),l.push(e("<input type='hidden'>").attr("name",t).attr("value",n).appendTo(i))}),l.push(e("<input type='hidden' name='X-Requested-With'>").attr("value","IFrame").appendTo(i)),accepts=t.dataTypes[0]&&t.accepts[t.dataTypes[0]]?t.accepts[t.dataTypes[0]]+("*"!==t.dataTypes[0]?", */*; q=0.01":""):t.accepts["*"],l.push(e("<input type='hidden' name='X-Http-Accept'>").attr("value",accepts).appendTo(i)),{send:function(o,a){r=e("<iframe src='javascript:false;' name='iframe-"+e.now()+"' style='display:none'></iframe>"),r.bind("load",function(){r.unbind("load").bind("load",function(){var e=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,t=e.documentElement?e.documentElement:e.body,i=t.getElementsByTagName("textarea")[0],r=i?i.getAttribute("data-type"):null,o=i?parseInt(i.getAttribute("response-code")):200,s="OK",l={text:r?i.value:t?t.innerHTML:null},c="Content-Type: "+(r||"text/html");a(o,s,l,c),setTimeout(n,50)}),i.attr("action",t.url).attr("target",r.attr("name")).attr("enctype","multipart/form-data").get(0).submit()}),r.insertAfter(i)},abort:function(){null!==r&&(r.unbind("load").attr("src","javascript:false;"),n())}}):void 0})}(jQuery),function(t){var n;t.remotipart=n={setup:function(e){e.one("ajax:beforeSend.remotipart",function(i,r,o){return delete o.beforeSend,o.iframe=!0,o.files=t(t.rails.fileInputSelector,e),o.data=e.serializeArray(),o.files.each(function(e,t){for(var n=o.data.length-1;n>=0;n--)o.data[n].name==t.name&&o.data.splice(n,1)}),o.processData=!1,void 0===o.dataType&&(o.dataType="script *"),o.data.push({name:"remotipart_submitted",value:!0}),t.rails.fire(e,"ajax:remotipartSubmit",[r,o])&&t.rails.ajax(o),n.teardown(e),!1}).data("remotipartSubmitted",!0)},teardown:function(e){e.unbind("ajax:beforeSend.remotipart").removeData("remotipartSubmitted")}},t(document).on("ajax:aborted:file","form",function(){var i=t(this);return n.setup(i),!t.support.submitBubbles&&t().jquery<"1.7"&&t.rails.callFormSubmitBindings(i)===!1?t.rails.stopEverything(e):(t.rails.handleRemote(i),!1)})}(jQuery);